<html>
    <head>
        <script src="library/d3.min.js" charset="utf-8"></script>
        <title>Test D3.js</title>
    </head>
    <body>
        <svg></svg>
        <script>
            d3.csv('../data/olympics_2012.csv',loaded);
            
            function loaded (data){
                console.log(data)
                
                var countries =  d3.nest()
                                .key(function(d) {
                                    return d.team;
                                })
                                .sortKeys(d3.ascending)
                                .entries(data);
                
                countries.sort(function(a,b) {
                    return d3.ascending(b.values.length, a.values.length)
                })
                               
                
                
                d3.select('svg')
                    .selectAll('rect')
                    .data(countries)
                    .enter()
                    .append('rect')
                    .attr('height',4)
                    .attr('width', function(d,i) {
                        return d.values.length
                    })
                    .attr('y', function (d,i) {
                        return i*5
                    })
                
                console.log(countries);
                
                d3.select('svg')
                    .attr('height', 1*countries.length)
                    .attr('fill', 'red')
                    .transition ()
                    .duration(2000)
                    .delay(1000) 
                    .attr('fill', '#a1f')
                    .transition ()
                    .duration(2000)
                    .attr('fill', 'red')
                    
                        
                    
            }
        </script>
    </body>
</html>